前提：先用docker  keycloak;
用令：

docker run -p 8180:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin quay.io/keycloak/keycloak:latest start-dev

/存，不然下面的步E需要在每次拥r候重新建;
docker run -p 8180:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin -v keycloak_data:/opt/keycloak/data quay.io/keycloak/keycloak:latest start-dev

登url: http://localhost:8180
入ぬ密a： admin/admin


  步骤一：创建 Realm

  左侧菜单上方下拉框（显示 "master"）
  → Create realm
  → Realm name: saml-demo
  → Create

  步骤二：创建 SAML2 Client

  左侧菜单 → Clients → Create client

  1. Client type: SAML
     Client ID: https://localhost:8080/saml2/metadata/keycloak
     → Next

  2. 配置页面填写：
     Root URL: https://localhost:8080
     Home URL: https://localhost:8080
     Valid redirect URIs: https://localhost:8080/*
     → Save

  步骤三：配置 Client 详细设置

  创建后进入 Client 详情页，确认以下配置：

  Settings 标签页：
  - Name ID format: email
  - Force name ID format: ON
  - Sign assertions: ON

  步骤四：创建测试用户

  左侧菜单 → Users → Add user
  - Username: testuser
  - Email: test@test.com
  - First name: Test
  - Last name: User
  → Create

  创建后 → Credentials 标签页
  → Set password
  - Password: test123
  - Temporary: OFF
  → Save

  步骤五：获取 IdP 元数据

  左侧菜单 → Realm settings → General 标签页
  → 找到 "Endpoints" 部分
  → 点击 "SAML 2.0 Identity Provider Metadata" 链接
  → 保存为 keycloak-saml-metadata.xml

  //生成後放在resource目下，改keycloak-saml-metadata.xml
  如果有}的，需要入C：
登url: http://localhost:8180
入ぬ密a： admin/admin
c糇鹊Clients
-->Clients list（x中我自己建的client）
--->cKey （下拉到Certificate，cImport key，Archive formatx Certificate PEM，把本地的saml-signing.crt上魃先ィ


步Ea充：

 }原因

  Keycloak 中的 client 配置 OpenID Connect fh，但你的 Spring Boot 用L使用 SAML2 fhM行JC。

  解Q方案

  在 Keycloak 管理控制台中，需要正_配置 SAML client：

  1. 登入 Keycloak 管理控制台 (http://localhost:8180/admin)
  2. M入 saml-demo realm
  3. 建新的 SAML Client（或修改F有 client）：
    - c Clients → Create client
    - Client type: x SAML（不是 OpenID Connect）
    - Client ID: https://localhost:8080/saml2/metadata/keycloak（必c application.yml 中的 entity-id 完全一致）
  4. 配置 Client O定：
    - Root URL: https://localhost:8080
    - Valid redirect URIs: https://localhost:8080/*
    - Master SAML Processing URL: https://localhost:8080/login/saml2/sso/keycloak
    - Sign Assertions: On
    - Client Signature Required: On（因槟阌信渲 signing credentials）
  5. 上 SP {C（如果 Client Signature Required _）：
    - 在 Keys tab 中入你的 saml-signing.crt

  你的 application.yml 中 entity-id 是 https://localhost:8080/saml2/metadata/keycloak，Keycloak 的 Client ID
  必完全匹配@值。


第三部的Client type忘x窳;

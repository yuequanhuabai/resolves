session对cookie的优化就是因为cookie存储在浏览器不安全吧，token我不是很理解

● 完全正确！Session 就是为了解决 Cookie 把敏感数据放在浏览器不安全的问题。

让我用更直观的方式给你讲讲 Token：

三者的本质区别

Cookie（寄存柜钥匙）

你：这是我的用户名和密码（明文）
服务器：好的，记住了
问题：钥匙上写着你的密码，别人捡到就完了

Session（寄存柜号码牌）

你：这是我的登录信息
服务器：好的，我存起来，给你一个号码牌 #123
你：以后每次拿着 #123 来取
服务器：（查柜子）#123 是张三，欢迎
问题：服务器需要维护一堆柜子（占内存）

Token（加密的通行证）

你：这是我的登录信息
服务器：我给你一个加密的通行证（包含你的身份信息）
"张三|VIP会员|2025-12-01到期" + 【服务器的私章】
你：以后每次带着这个通行证来
服务器：（验证私章）嗯，是我盖的章，通行证没被篡改，放行！
优点：服务器不用存储，只需要验证"章"是不是自己盖的

Token 的关键特点

1. 无状态

- Session：服务器要记住你（占内存/数据库）
- Token：服务器不记住你，但能验证你的通行证是真的

2. 自包含

Token 里包含了用户信息（加密的）：
// JWT Token 解码后的内容
{
"user_id": 123,
"username": "张三",
"role": "admin",
"exp": 1735689600  // 过期时间
}

3. 工作流程

登录时：
用户：账号密码
服务器：验证通过，生成 Token（用私钥签名）
用户：保存 Token 到 LocalStorage

后续请求：
用户：请求头带上 Authorization: Bearer <token>
服务器：验证签名 → 解密 → 读取用户信息 → 直接用
（不需要查数据库/Redis）

为什么需要 Token？

Session 的痛点场景：

场景1：分布式系统
你的 Session 存在服务器 A
下次请求被负载均衡到服务器 B
服务器 B：不认识你（Session 不共享）
解决：用 Redis 共享 Session → 增加复杂度

场景2：移动 App
- App 不支持 Cookie 自动携带
- 需要手动在请求头里传递认证信息
- Token 更灵活，放在 Header 里即可

场景3：跨域 API
前端：https://www.example.com
后端：https://api.example.com
Cookie 跨域有限制，Token 无此问题

三者对比总结

| 特性    | Cookie | Session | Token (JWT)  |
  |-------|--------|---------|--------------|
| 存储位置  | 浏览器    | 服务器     | 浏览器          |
| 服务器压力 | 无      | 大（需存储）  | 无（无状态）       |
| 安全性   | 低      | 高       | 中（防篡改，但可被窃取） |
| 适用场景  | 简单网站   | 传统 Web  | 分布式/移动端/API  |
| 扩展性   | 中      | 差       | 好            |

一句话理解 Token

Token = 服务器签发的加密通行证，你拿着它到处用，服务器只需验证"章"是不是真的，不用记住你

这样理解了吗？